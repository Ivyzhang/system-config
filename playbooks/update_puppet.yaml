---
- hosts: "localhost:!disabled"
  connection: local
  gather_facts: false
  tasks:
  - git:
      repo: ssh://xivgit.xiv.ibm.com/git/host/devops/openstack_ci/system_config.git
      dest: /opt/system-config/production
      force: yes
  - shell: ./install_modules.sh
    args:
      chdir: /opt/system-config/production
    when: dry_run is not defined
  - shell: ansible-galaxy install --force -r roles.yaml
    args:
      chdir: /opt/system-config/production
